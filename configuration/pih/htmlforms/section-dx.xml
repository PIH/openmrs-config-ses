<htmlform formUuid="3498f204-a6fa-4df0-b7fd-a94eb03a43c9" formName="Diagnostic" formVersion="1.0">

    <style type="text/css">
        <ifMode mode="VIEW" include="false">

            #data-collection {
                display: inline-block;
                width: 58%;
                vertical-align: top;
            }

            #encounter-diagnoses-target {
                display: inline-block;
                width: 40%;
                vertical-align: top;
            }

            #encounter-diagnoses-app {
                margin-bottom: 20px;
            }

            .hasDatepicker {
                min-width: 100%;
            }

            p.radio > * {
            display: inline;
            float: none !important;
            min-width: initial;
            }

        </ifMode>
    </style>
    <ifMode mode="VIEW" include="false">

        <script type="text/javascript">
            jq(document).ready(function() {

                // handle our custom functionality for triggering going to the next section when the "Next" button is clicked
                jq('#next').click(function() {
                    window.htmlForm.getBeforeSubmit().push(function () {
                        window.htmlForm.setReturnUrl(window.htmlForm.getReturnUrl() + "&amp;goToNextSection=pihcore-diagnosis");
                        return true;
                    });

                    window.htmlForm.submitHtmlForm();
                })

                jq('#submit').click(function() {
                    window.htmlForm.submitHtmlForm();
                })

            });

            jq(function() {

                var hasValue = function(element) {
                    return jq(element).find('.diagnosis-name input').val();
                };

                var hideOtherDiagnosis = function() {
                    jq('#diagnosis-2').hide();
                    jq('#diagnosis-3').hide();
                    jq('#diagnosis-4').hide();
                    jq('#diagnosis-5').hide();
                    jq('#diagnosis-6').hide();
                    jq('#diagnosis-7').hide();
                    jq('#diagnosis-8').hide();
                };

                if (!hasValue('#diagnosis-2') &amp;&amp; !hasValue('#diagnosis-3') &amp;&amp; !hasValue('#diagnosis-4')
                    &amp;&amp; !hasValue('#diagnosis-5') &amp;&amp; !hasValue('#diagnosis-6') &amp;&amp;
                    !hasValue('#diagnosis-7')
                    &amp;&amp; !hasValue('#diagnosis-8')) {
                        hideOtherDiagnosis();
                        jq('#show-more-diagnosis-button').show();
                }

                jq('#show-more-diagnosis-button').click(function() {
                    jq('.diagnosis').show();
                    jq('#show-more-diagnosis-button').hide();
                    jq('#show-less-diagnosis-button').show();
                });

                jq('#show-less-diagnosis-button').click(function() {
                    hideOtherDiagnosis();
                    jq('#show-less-diagnosis-button').hide();
                    jq('#show-more-diagnosis-button').show();
                });

            })

        </script>
    </ifMode>

    <div id="section-container-color">
        <repeat with="['1'],['2'],['3'],['4'],['5'],['6'],['7'],['8']">
            <span id="diagnosis-{0}" class="diagnosis">
                <obsgroup groupingConceptId="PIH:Visit Diagnoses">
                    <h3>
                        Diagnostico
                    </h3>
                    <fieldset clas="diagnosis">
                        <p class="field-error" style="display:none"></p>
                        <p>
                            <label>Nombre del diagnostico</label>
                            <obs id="name{0}" class="diagnosis-name" conceptId="PIH:DIAGNOSIS" style="autocomplete" answerConceptSetIds="34280962-a42d-43e1-a6bd-fcff6c31f7e3"/>
                        </p>
                        <p class="inline">
                            <obs id="confirmation{0}" class="confirmation-radio Input" conceptId="PIH:CLINICAL IMPRESSION DIAGNOSIS CONFIRMED" style="radio" answerConceptIds="PIH:CONFIRMED,PIH:PRESUMED,CIEL:1688" answerLabels="Definitivo,Probable,Repetido"/>
                        </p>
                    </fieldset>
                </obsgroup>
            </span>
        </repeat>
        <button id="show-more-diagnosis-button" type="button" style="display:none">
                <uimessage code="pihcore.showMore"/>
        </button>
        <button id="show-less-diagnosis-button" type="button" style="display:none">
                <uimessage code="pihcore.showLess"/>
        </button>
    </div>

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <includeIf velocityTest="$encounter.encounterType.uuid != '00e5ebb2-90ec-11e8-9eb6-529269fb1459'">
                <button id="next" type="button" class="submitButton confirm right"><uimessage code="emr.next"/><i class="icon-spinner icon-spin icon-2x" style="display: none; margin-left: 10px;"></i></button>
            </includeIf>
            <button id="submit" class="submitButton confirm right"><uimessage code="mirebalais.save"/><i class="icon-spinner icon-spin icon-2x" style="display: none; margin-left: 10px;"></i></button>
            <button id="cancel" type="button" class="cancel"><uimessage code="emr.cancel"/></button>
        </div>
    </ifMode>

</htmlform>
